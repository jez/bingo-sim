<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BinaryLiterals             #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE NumericUnderscores         #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- This module contains the data types we'll be using, which is really just a</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- way to represent and operate on boards.</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- For our purposes, we only need random boards, so it's sufficient to identify</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- a board position by its index and then represent a board by a bit vector.</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Compared to a list or some other kind of sequence, this lets us use less</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- space and perform operations on boards in fewer instructions.</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Since we're using a 'Word64' but only representing boards with 36 grid</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- spaces, we only use the 36 least significant bits: @0xf_ffff_ffff@</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- We represent boards in row-major order, so each multiple of 6 bits is a row.</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">BingoSim.Board</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Bits</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Text.Printf</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- * Boards</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | The type of a 6x6 game board, as a bit sequence. Only the 36 least</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- significant bits are meaningful.</span><span>
</span><a name="line-28"></a><span class="hs-keyword">newtype</span><span> </span><a name="Board"><a href="BingoSim.Board.html#Board"><span class="hs-identifier">Board</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Board"><a href="BingoSim.Board.html#Board"><span class="hs-identifier">Board</span></a></a><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-keyword">deriving</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">PrintfArg</span><span> </span><span class="hs-comment">-- ^ So we can access the underlying 'Word64' easily when</span><span>
</span><a name="line-31"></a><span>                </span><span class="hs-comment">-- printing:</span><span>
</span><a name="line-32"></a><span>                </span><span class="hs-comment">--</span><span>
</span><a name="line-33"></a><span>                </span><span class="hs-comment">-- &gt;&gt;&gt; printf &quot;%#0*b\n&quot; 38 (Board 0x1)</span><span>
</span><a name="line-34"></a><span>                </span><span class="hs-comment">-- 0b000000000000000000000000000000000001</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- | Only compares the 36 least significant bits.</span><span>
</span><a name="line-38"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024286"><a href="#local-6989586621679024286"><span class="hs-identifier">board1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024287"><a href="#local-6989586621679024287"><span class="hs-identifier">board2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024288"><a href="#local-6989586621679024288"><span class="hs-identifier">mask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0xf_ffff_ffff</span><span>
</span><a name="line-41"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024286"><span class="hs-identifier hs-var">board1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679024288"><span class="hs-identifier hs-var">mask</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024287"><span class="hs-identifier hs-var">board2</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679024288"><span class="hs-identifier hs-var">mask</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- Visualize a board as a 6x6 grid.</span><span>
</span><a name="line-46"></a><span class="hs-comment">--</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- &gt;&gt;&gt; print (Board 0x123456789)</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- 000100</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- 100011</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- 010001</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- 010110</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- 011110</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- 001001</span><span>
</span><a name="line-54"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>  </span><a name="local-8214565720323790326"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024279"><a href="#local-6989586621679024279"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024280"><a href="#local-6989586621679024280"><span class="hs-identifier">r1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row1"><span class="hs-identifier hs-var">row1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">30</span><span>
</span><a name="line-57"></a><span>        </span><a name="local-6989586621679024281"><a href="#local-6989586621679024281"><span class="hs-identifier">r2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row2"><span class="hs-identifier hs-var">row2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-58"></a><span>        </span><a name="local-6989586621679024282"><a href="#local-6989586621679024282"><span class="hs-identifier">r3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row3"><span class="hs-identifier hs-var">row3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">18</span><span>
</span><a name="line-59"></a><span>        </span><a name="local-6989586621679024283"><a href="#local-6989586621679024283"><span class="hs-identifier">r4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row4"><span class="hs-identifier hs-var">row4</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span>
</span><a name="line-60"></a><span>        </span><a name="local-6989586621679024284"><a href="#local-6989586621679024284"><span class="hs-identifier">r5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row5"><span class="hs-identifier hs-var">row5</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftR</span><span class="hs-special">`</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-61"></a><span>        </span><a name="local-6989586621679024285"><a href="#local-6989586621679024285"><span class="hs-identifier">r6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row6"><span class="hs-identifier hs-var">row6</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-string">&quot;%06b\n%06b\n%06b\n%06b\n%06b\n%06b\n&quot;</span><span> </span><a href="#local-6989586621679024280"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679024281"><span class="hs-identifier hs-var">r2</span></a><span> </span><a href="#local-6989586621679024282"><span class="hs-identifier hs-var">r3</span></a><span> </span><a href="#local-6989586621679024283"><span class="hs-identifier hs-var">r4</span></a><span> </span><a href="#local-6989586621679024284"><span class="hs-identifier hs-var">r5</span></a><span> </span><a href="#local-6989586621679024285"><span class="hs-identifier hs-var">r6</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- * Bingos</span><span>
</span><a name="line-65"></a><span class="hs-comment">--</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- $Bingos</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- The main operation we want to do on a board is check whether it has a bingo</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- or not.</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Check whether there's a bingo, and if so, return the BingoLocation</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- corresponding to where the bingo occured (i.e., which row, column, or</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- diagonal).</span><span>
</span><a name="line-73"></a><span class="hs-comment">--</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- In the case where there are multiple bingos, returns one of them</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- arbitrarily.</span><span>
</span><a name="line-76"></a><span class="hs-comment">--</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- &gt;&gt;&gt; hasBingo (Board 0x123456789)</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- &gt;&gt;&gt; hasBingo (Board 0x3f)</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- Just Row6</span><span>
</span><a name="line-81"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-type">Board</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="BingoSim.Board.html#BingoLocation"><span class="hs-identifier hs-type">BingoLocation</span></a><span>
</span><a name="line-82"></a><a name="hasBingo"><a href="BingoSim.Board.html#hasBingo"><span class="hs-identifier">hasBingo</span></a></a><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024340"><a href="#local-6989586621679024340"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024340"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#dia1"><span class="hs-identifier hs-var">dia1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#dia1"><span class="hs-identifier hs-var">dia1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Dia1"><span class="hs-identifier hs-var">Dia1</span></a><span>
</span><a name="line-83"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024341"><a href="#local-6989586621679024341"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024341"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#dia2"><span class="hs-identifier hs-var">dia2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#dia2"><span class="hs-identifier hs-var">dia2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Dia2"><span class="hs-identifier hs-var">Dia2</span></a><span>
</span><a name="line-84"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024342"><a href="#local-6989586621679024342"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024342"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row1"><span class="hs-identifier hs-var">row1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row1"><span class="hs-identifier hs-var">row1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row1"><span class="hs-identifier hs-var">Row1</span></a><span>
</span><a name="line-85"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024343"><a href="#local-6989586621679024343"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024343"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row2"><span class="hs-identifier hs-var">row2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row2"><span class="hs-identifier hs-var">row2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row2"><span class="hs-identifier hs-var">Row2</span></a><span>
</span><a name="line-86"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024344"><a href="#local-6989586621679024344"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024344"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row3"><span class="hs-identifier hs-var">row3</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row3"><span class="hs-identifier hs-var">row3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row3"><span class="hs-identifier hs-var">Row3</span></a><span>
</span><a name="line-87"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024345"><a href="#local-6989586621679024345"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024345"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row4"><span class="hs-identifier hs-var">row4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row4"><span class="hs-identifier hs-var">row4</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row4"><span class="hs-identifier hs-var">Row4</span></a><span>
</span><a name="line-88"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024346"><a href="#local-6989586621679024346"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024346"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row5"><span class="hs-identifier hs-var">row5</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row5"><span class="hs-identifier hs-var">row5</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row5"><span class="hs-identifier hs-var">Row5</span></a><span>
</span><a name="line-89"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024347"><a href="#local-6989586621679024347"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024347"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#row6"><span class="hs-identifier hs-var">row6</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#row6"><span class="hs-identifier hs-var">row6</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Row6"><span class="hs-identifier hs-var">Row6</span></a><span>
</span><a name="line-90"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024348"><a href="#local-6989586621679024348"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024348"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col1"><span class="hs-identifier hs-var">col1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col1"><span class="hs-identifier hs-var">col1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col1"><span class="hs-identifier hs-var">Col1</span></a><span>
</span><a name="line-91"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024349"><a href="#local-6989586621679024349"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024349"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col2"><span class="hs-identifier hs-var">col2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col2"><span class="hs-identifier hs-var">col2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col2"><span class="hs-identifier hs-var">Col2</span></a><span>
</span><a name="line-92"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024350"><a href="#local-6989586621679024350"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024350"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col3"><span class="hs-identifier hs-var">col3</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col3"><span class="hs-identifier hs-var">col3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col3"><span class="hs-identifier hs-var">Col3</span></a><span>
</span><a name="line-93"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024351"><a href="#local-6989586621679024351"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024351"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col4"><span class="hs-identifier hs-var">col4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col4"><span class="hs-identifier hs-var">col4</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col4"><span class="hs-identifier hs-var">Col4</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024352"><a href="#local-6989586621679024352"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024352"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col5"><span class="hs-identifier hs-var">col5</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col5"><span class="hs-identifier hs-var">col5</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col5"><span class="hs-identifier hs-var">Col5</span></a><span>
</span><a name="line-95"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-special">(</span><a href="BingoSim.Board.html#Board"><span class="hs-identifier hs-var">Board</span></a><span> </span><a name="local-6989586621679024353"><a href="#local-6989586621679024353"><span class="hs-identifier">board</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024353"><span class="hs-identifier hs-var">board</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="BingoSim.Board.html#col6"><span class="hs-identifier hs-var">col6</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BingoSim.Board.html#col6"><span class="hs-identifier hs-var">col6</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="BingoSim.Board.html#Col6"><span class="hs-identifier hs-var">Col6</span></a><span>
</span><a name="line-96"></a><span class="hs-identifier">hasBingo</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | An enum of where a bingo could occur on a 6x6 board.</span><span>
</span><a name="line-99"></a><span class="hs-keyword">data</span><span> </span><a name="BingoLocation"><a href="BingoSim.Board.html#BingoLocation"><span class="hs-identifier">BingoLocation</span></a></a><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Dia1"><a href="BingoSim.Board.html#Dia1"><span class="hs-identifier">Dia1</span></a></a><span> </span><span class="hs-comment">-- ^ Top left to bottom right</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Dia2"><a href="BingoSim.Board.html#Dia2"><span class="hs-identifier">Dia2</span></a></a><span> </span><span class="hs-comment">-- ^ Top right to bottom left</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row1"><a href="BingoSim.Board.html#Row1"><span class="hs-identifier">Row1</span></a></a><span> </span><span class="hs-comment">-- ^ Top row</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row2"><a href="BingoSim.Board.html#Row2"><span class="hs-identifier">Row2</span></a></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row3"><a href="BingoSim.Board.html#Row3"><span class="hs-identifier">Row3</span></a></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row4"><a href="BingoSim.Board.html#Row4"><span class="hs-identifier">Row4</span></a></a><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row5"><a href="BingoSim.Board.html#Row5"><span class="hs-identifier">Row5</span></a></a><span>
</span><a name="line-107"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Row6"><a href="BingoSim.Board.html#Row6"><span class="hs-identifier">Row6</span></a></a><span> </span><span class="hs-comment">-- ^ Bottom row</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col1"><a href="BingoSim.Board.html#Col1"><span class="hs-identifier">Col1</span></a></a><span> </span><span class="hs-comment">-- ^ Far left column</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col2"><a href="BingoSim.Board.html#Col2"><span class="hs-identifier">Col2</span></a></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col3"><a href="BingoSim.Board.html#Col3"><span class="hs-identifier">Col3</span></a></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col4"><a href="BingoSim.Board.html#Col4"><span class="hs-identifier">Col4</span></a></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col5"><a href="BingoSim.Board.html#Col5"><span class="hs-identifier">Col5</span></a></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Col6"><a href="BingoSim.Board.html#Col6"><span class="hs-identifier">Col6</span></a></a><span> </span><span class="hs-comment">-- ^ Far right column</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- * Board Constants</span><span>
</span><a name="line-117"></a><span class="hs-comment">--</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- $Constants</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- These are a handful of bit masks to project out the rows, columns, and</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- diagonals of a board.</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Diagonal from top left to bottom right</span><span>
</span><a name="line-123"></a><span class="hs-identifier">dia1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-124"></a><a name="dia1"><a href="BingoSim.Board.html#dia1"><span class="hs-identifier">dia1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b100000010000001000000100000010000001</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- | Diagonal from top right to bottom left</span><span>
</span><a name="line-126"></a><span class="hs-identifier">dia2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-127"></a><a name="dia2"><a href="BingoSim.Board.html#dia2"><span class="hs-identifier">dia2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000001000010000100001000010000100000</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- | Top row</span><span>
</span><a name="line-129"></a><span class="hs-identifier">row1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-130"></a><a name="row1"><a href="BingoSim.Board.html#row1"><span class="hs-identifier">row1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b111111000000000000000000000000000000</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Second row from top</span><span>
</span><a name="line-132"></a><span class="hs-identifier">row2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-133"></a><a name="row2"><a href="BingoSim.Board.html#row2"><span class="hs-identifier">row2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000000111111000000000000000000000000</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- | Third row from top</span><span>
</span><a name="line-135"></a><span class="hs-identifier">row3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-136"></a><a name="row3"><a href="BingoSim.Board.html#row3"><span class="hs-identifier">row3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000000000000111111000000000000000000</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Fourth row from top</span><span>
</span><a name="line-138"></a><span class="hs-identifier">row4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-139"></a><a name="row4"><a href="BingoSim.Board.html#row4"><span class="hs-identifier">row4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000000000000000000111111000000000000</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- | Fifth row from top</span><span>
</span><a name="line-141"></a><span class="hs-identifier">row5</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-142"></a><a name="row5"><a href="BingoSim.Board.html#row5"><span class="hs-identifier">row5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000000000000000000000000111111000000</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- | Bottom row</span><span>
</span><a name="line-144"></a><span class="hs-identifier">row6</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-145"></a><a name="row6"><a href="BingoSim.Board.html#row6"><span class="hs-identifier">row6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000000000000000000000000000000111111</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Far left column</span><span>
</span><a name="line-147"></a><span class="hs-identifier">col1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-148"></a><a name="col1"><a href="BingoSim.Board.html#col1"><span class="hs-identifier">col1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b100000100000100000100000100000100000</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- | Second column from left</span><span>
</span><a name="line-150"></a><span class="hs-identifier">col2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-151"></a><a name="col2"><a href="BingoSim.Board.html#col2"><span class="hs-identifier">col2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b010000010000010000010000010000010000</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Third column from left</span><span>
</span><a name="line-153"></a><span class="hs-identifier">col3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-154"></a><a name="col3"><a href="BingoSim.Board.html#col3"><span class="hs-identifier">col3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b001000001000001000001000001000001000</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- | Fourth column from left</span><span>
</span><a name="line-156"></a><span class="hs-identifier">col4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-157"></a><a name="col4"><a href="BingoSim.Board.html#col4"><span class="hs-identifier">col4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000100000100000100000100000100000100</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- | Fifth column from left</span><span>
</span><a name="line-159"></a><span class="hs-identifier">col5</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-160"></a><a name="col5"><a href="BingoSim.Board.html#col5"><span class="hs-identifier">col5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000010000010000010000010000010000010</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Far right column</span><span>
</span><a name="line-162"></a><span class="hs-identifier">col6</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word64</span><span>
</span><a name="line-163"></a><a name="col6"><a href="BingoSim.Board.html#col6"><span class="hs-identifier">col6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0b000001000001000001000001000001000001</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a></pre></body></html>